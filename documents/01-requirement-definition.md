# プロジェクト要件定義書: MyBlog-AWS

## 1. プロジェクト概要

### 1.1 目的

* AWSサーバーレスアーキテクチャの深いキャッチアップ（学習）。
* 自身の経験（ヨーロッパでの生活、エンジニアリング等）を画像・動画・テキストで共有するプラットフォームの構築。
* インフラを抽象化し、特定のコンテンツに依存しない再利用性の高い基盤の実現。

### 1.2 ターゲット

* **セルフ**: 自身の経験の振り返り。
* **知人**: 近況報告や情報共有。
* **不特定多数**: 著者の経験に関連する事項に興味・関心を持つユーザー。

---

## 2. 開発思想（フィロソフィー）

### 2.1 学習アプローチ

* **自律的実装**: AIによるコード自動生成や過度な補完を避け、自身の力で実装する。
* **公式リファレンス重視**: 実装の根拠はAWS公式ドキュメント等の一次情報に求める。

### 2.2 設計思想

* **Headless構造**: バックエンド/インフラを抽象的なメディア・ブログ基盤として構築し、フロントエンドの実装でオリジナリティを追求する。
* **拡張性**: 将来的な「いいね」や「コメント」機能の追加を許容するデータ設計を行う。

---

## 3. 機能要件

### 3.1 記事管理（管理者）

* **操作環境**: ブラウザ上の管理画面から操作を行う。
* **CRUD操作**: 記事の作成、取得、更新、削除が可能であること。
* **ステータス管理**: 記事ごとに以下の状態を保持・切り替えできること。
* `DRAFT`: 下書き状態。
* `PUBLISHED`: 公開状態。
* `ARCHIVE`: 非表示（保存）状態。


* **コンテンツ構造**: テキスト、画像、動画URL（S3/YouTube）をブロック単位で組み合わせた配列構造をサポートする。

### 3.2 メディア管理

* **画像**: S3へのアップロードおよびCloudFront経由での配信。
* **動画**: S3からの直接配信およびYouTube埋め込みコードの管理。

### 3.3 認証

* **管理者認証**: 管理画面へのアクセスおよび記事操作の実行にはAmazon Cognitoによる認証を必須とする。

---

## 4. 非機能要件

### 4.1 パフォーマンス・コスト

* **キャッシュ戦略**: 閲覧側のアクセスはCloudFrontでキャッシュし、コスト削減と表示高速化を図る。
* **サーバーレス**: 常時稼働サーバーを排除し、従量課金モデルによる低コスト運用を実現する。

### 4.2 運用・保守

* **IaC**: AWS CDKを用いて全てのインフラをコード管理する。
* **Stack構成**: ライフサイクルに応じ、ステートフル（DB/S3）とステートレス（Lambda/API）のStackを分離する。
* **データ整形**: APIレスポンスのキー名は `lowerCamelCase` に統一し、フロントエンドでの一貫性を保つ。

---

## 5. 技術選定（インフラストラクチャ）

* **Hosting**: Amazon S3 (Static Website Hosting) + Amazon CloudFront
* **API**: Amazon API Gateway + AWS Lambda (Python)
* **Database**: Amazon DynamoDB
* **Auth**: Amazon Cognito
* **Provisioning**: AWS CDK (TypeScript)


---

# MyBlog-AWS 要件定義：設計決定の背景 (Design Rationale)

## 1. コンテンツのブロック配列構造 (Block-based Content Structure)

### 【意図】

本文を単一の大きな文字列（HTMLやMarkdown）として保存せず、`{ type: "text", value: "..." }` のようなブロック単位の配列として保持する。

### 【背景と理由】

* **フロントエンドのオリジナリティの担保**:
インフラを抽象化し、フロントエンドの実装で個性を出すという思想に基づいている。データがブロック化されていれば、フロントエンド側で「特定の画像ブロックにだけアニメーションを付ける」「動画の前後でレイアウトを動的に変える」といった処理が、文字列パースなしで容易に実現できる。
* **マルチプラットフォーム・再利用性への対応**:
将来的にモバイルアプリや別のUIフレームワークへ移行する際、プレーンな文字列よりも、構造化されたデータの方がパースしやすく、表示の整合性を保ちやすい。
* **メディア管理の厳密化**:
画像や動画がテキストのどこに挿入されているかをメタデータとして明確に分離することで、S3バケット内のファイル参照（リンク切れチェック等）の自動化が容易になる。

## 2. 記事ステータスへの `ARCHIVE` の追加

### 【意図】

`DRAFT`, `PUBLISHED` に加え、`ARCHIVE` 状態を定義する。

### 【背景と理由】

* **物理削除のリスク回避**:
「不特定多数への共有」を目的とする以上、一度公開した記事を完全に削除（物理削除）すると、外部からのリンク切れが発生し、SEOやユーザー体験を損なう。`ARCHIVE` による論理的な非表示制御を設けることで、管理上の柔軟性を確保する。
* **将来の拡張性（履歴保持）**:
「いつ公開し、いつアーカイブしたか」という履歴を残すことで、自身の経験の振り返り という目的において、時系列データの整合性を保つ。

## 3. インフラの抽象化と再利用性の追求

### 【意図】

ヨーロッパでの経験という具体的なトピックに依存させず、インフラを「汎用メディア・ブログ基盤」として構築する。

### 【背景と理由】

* **エンジニアとしての資産化**:
今回のプロジェクトを「特定のブログを作る作業」ではなく「ブログ作成用ツールキット（フレームワーク）を作る作業」と定義することで、アイルランドでの業務や他のプロジェクトにも転用可能な、より高度な技術的キャッチアップを狙う。
* **CDKのStack分割の最適化**:
インフラが抽象化されていれば、データベースやストレージといった「土台」と、APIやUIといった「機能」を疎結合に保つことができ、CDKのベストプラクティスである「ライフサイクルに応じたStack分割」をより自然に体現できる。
